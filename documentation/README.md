# Table of Contents

-   [API Documentation](#api-documentation)
    -   [Authentication](#authentication)
        -   [Login](#login)
        -   [Register](#register)
        -   [Refresh Token](#refresh-token)
        -   [Me](#me)
        -   [Logout](#logout)
    -   [Robots](#robots)
        -   [Paginate](#paginate)
        -   [Show robot](#show-robot)
        -   [Leader-board](#leader-board)
    -   [Dance Offs](#dance-Offs)
        -   [Paginate](#paginate)
        -   [Dance](#dance)
-   [Containerization](#containerization)
-   [Hosting](#hosting)
-   [Frontend](#frontend)
-   [Testing](#testing)

# API Documentation

Below you will find all the API endpoints and how to use them.

**API Url**

```
APP_URL/api
```

Where the `APP_URL` is the `.env` variable where the url for the app is specified.

## Authentication

The app uses **Bearer authentication** (also called **token authentication**) it's an HTTP authentication scheme that involves security tokens called bearer tokens. The token is a string generated by the server in response to a login request. The client must send this token in the Authorization header when making requests to protected resources: [Read more](https://swagger.io/docs/specification/authentication/bearer-authentication/)

```
Authorization: Bearer <token>
```

### Login

To log in, initiate a `POST` request to the following API endpoint:

-   Request `POST` `/login`
-   Params

    ```json
    {
        "email": "jane.doe@groovybot.com",
        "password": "secret"
    }
    ```

-   Response

    -   Correct credentials

        ```json
        {
            "access_token": "token",
            "token_type": "bearer",
            "expires_in": 3600
        }
        ```

    -   Incorrect credentials

        ```json
        {
            "error": "Unauthorized"
        }
        ```

### Register

The app comes with a register endpoint to register new users:

-   Request `POST` `/register`
-   Params

    ```json
    {
        "name": "Jane Doe",
        "email": "jane.doe@groovybot.com",
        "password": "secret",
        "password_confirmation": "secret"
    }
    ```

    -   Rules
        -   Email must be unique
        -   Password is a minimum of 8 character and must be confirmed

-   Response

    -   Correct credentials

        ```json
        {
            "user": {
                "id": 5,
                "name": "Jane Doe",
                "email": "jane.doe@groovybot.com",
                "created_at": "2021-09-01T20:26:21.000000Z",
                "updated_at": "2021-09-01T20:26:21.000000Z"
            },
            "message": "CREATED"
        }
        ```

    -   Duplicate email or incorrect password

        ```json
        {
            "email": ["The email has already been taken."],
            "password": ["The password confirmation does not match."]
        }
        ```

> ## Token usage
>
> The `token` received by the login must be used on all the endpoints mentioned below

### Refresh token

To refresh the API token:

-   Request `GET` `/refresh`

-   Response

    -   Valid token

        ```json
        {
            "access_token": "token",
            "token_type": "bearer",
            "expires_in": 3600
        }
        ```

    -   Invalid token

        ```json
        {
            "error": "Unauthorized"
        }
        ```

### Me

To get the logged in user details:

-   Request `GET` `/me`

-   Response

    ```json
    {
        "id": 2,
        "name": "John Doe",
        "email": "john.doe@groovybot.com",
        "created_at": "2021-08-30T23:19:26.000000Z",
        "updated_at": "2021-08-30T23:19:26.000000Z"
    }
    ```

### Logout

To logout:

-   Request `GET` `/logout`

-   Response

    ```json
    {
        "message": "Successfully logged out"
    }
    ```

> ## Pagination
>
> On the paginate requests, a limit can be provided to the paginator to get a specific number of items, default is 25.
>
> ```json
> {
>     "limit": 30
> }
> ```

## Robots

### Paginate

To retrieve paginated list of robots:

-   Request `GET` `/robots`

-   Response

    ```json
    {
        "robots": {
            "data": [
                {
                    "id": 1,
                    "name": "Aniya Ratke",
                    "powerMove": "3 Step",
                    "experience": 17,
                    "outOfOrder": 0,
                    "avatar": "https://robohash.org/aniya-ratke.png",
                    "created_at": "2021-09-02T14:24:32.000000Z",
                    "updated_at": "2021-09-02T14:24:32.000000Z"
                },
                ...
            ],
            "meta": {
                "total": 100,
                "count": 25,
                "per_page": 25,
                "current_page": 1,
                "total_pages": 4
            }
        }
    }
    ```

### Show robot

Retrieve individual robot:

-   Request `GET` `/robots/{robot}/show`

-   Response

    -   Valid ID provided
        ```json
        {
            "robot": {
                "id": 1,
                "name": "Aniya Ratke",
                "powerMove": "3 Step",
                "experience": 17,
                "outOfOrder": 0,
                "avatar": "https://robohash.org/aniya-ratke.png",
                "created_at": "2021-09-02T14:24:32.000000Z",
                "updated_at": "2021-09-02T14:24:32.000000Z"
            }
        }
        ```
    -   Invalid ID
        ```json
        {
            "message": "Robot Not Found!"
        }
        ```

### Leader-board

To retrieve the leader-board for the robots, the results are ordered in a DESC order showing robots that have most wins:

-   Request `GET` `/robots/leader-board`

-   Response

    ```json
    {
        "robots": {
            "data": [
                {
                    "id": 5,
                    "name": "Katarina Bayer",
                    "powerMove": "6 Step",
                    "experience": 20,
                    "outOfOrder": 1,
                    "avatar": "https:\/\/katarina-bayer.png",
                    "created_at": "2021-09-02T14:24:32.000000Z",
                    "updated_at": "2021-09-02T14:24:32.000000Z"
                },
                ...
            ],
            "meta": {
                "total": 100,
                "count": 25,
                "per_page": 25,
                "current_page": 1,
                "total_pages": 4
            }
        }
    }
    ```

## Dance Offs

### Paginate

To retrieve paginated list of dance-offs:

-   Request `GET` `/dance-offs`

-   Response

    ```json
    {
        "danceOffs": {
            "data": [
                {
                    "id": 8,
                    "firstContender": {
                        "id": 1,
                        "name": "Aniya Ratke",
                        "powerMove": "3 Step",
                        "experience": 17,
                        "outOfOrder": 0,
                        "avatar": "https:\/\/aniya-ratke.png",
                        "created_at": "2021-09-02T14:24:32.000000Z",
                        "updated_at": "2021-09-02T14:24:32.000000Z"
                    },
                    "secondContender": {
                        "id": 5,
                        "name": "Katarina Bayer",
                        "powerMove": "6 Step",
                        "experience": 20,
                        "outOfOrder": 1,
                        "avatar": "https:\/\/katarina-bayer.png",
                        "created_at": "2021-09-02T14:24:32.000000Z",
                        "updated_at": "2021-09-02T14:24:32.000000Z"
                    },
                    "winner": {
                        "id": 5,
                        "name": "Katarina Bayer",
                        "powerMove": "6 Step",
                        "experience": 20,
                        "outOfOrder": 1,
                        "avatar": "https:\/\/katarina-bayer.png",
                        "created_at": "2021-09-02T14:24:32.000000Z",
                        "updated_at": "2021-09-02T14:24:32.000000Z"
                        },
                    "created_at": "2021-09-03T10:08:24.000000Z",
                    "updated_at": "2021-09-03T10:08:24.000000Z"
                },
                ...
            ],
            "meta": {
                "total": 100,
                "count": 25,
                "per_page": 25,
                "current_page": 1,
                "total_pages": 4
            }
        }
    }
    ```

### Dance

You can initiate a dance off with the request below:

There are 5 battles with each battle having 1 winner, a winning team is the team with the most one battles.

-   Request `GET` `/dance-offs/dance`

-   Params

    ```json
    {
        "firstTeam": [1, 2, 4, 55, 43],
        "secondTeam": [5, 45, 44, 65, 32]
    }
    ```

    -   Rules

        -   2 teams are required
        -   A team cannot have a duplicate member
        -   A team can contain only 5 members.
        -   A member cannot be duplicated between the 2 teams

-   Response

    -   Valid Teams and team members
        ```json
        {
            "results": {
                "winner": "The winner of this dance off is the First Team",
                "battles": [
                    {
                        "id": 96,
                        "firstContender": {
                            "id": 1,
                            "name": "Aniya Ratke",
                            "powerMove": "3 Step",
                            "experience": 17,
                            "outOfOrder": 0,
                            "avatar": "https://robohash.org/aniya-ratke.png",
                            "created_at": "2021-09-02T14:24:32.000000Z",
                            "updated_at": "2021-09-02T14:24:32.000000Z"
                        },
                        "secondContender": {
                            "id": 5,
                            "name": "Katarina Bayer",
                            "powerMove": "6 Step",
                            "experience": 20,
                            "outOfOrder": 1,
                            "avatar": "https://robohash.org/katarina-bayer.png",
                            "created_at": "2021-09-02T14:24:32.000000Z",
                            "updated_at": "2021-09-02T14:24:32.000000Z"
                        },
                        "winner": {
                            "id": 5,
                            "name": "Katarina Bayer",
                            "powerMove": "6 Step",
                            "experience": 20,
                            "outOfOrder": 1,
                            "avatar": "https://robohash.org/katarina-bayer.png",
                            "created_at": "2021-09-02T14:24:32.000000Z",
                            "updated_at": "2021-09-02T14:24:32.000000Z"
                        },
                        "created_at": "2021-09-03T10:57:15.000000Z",
                        "updated_at": "2021-09-03T10:57:15.000000Z"
                    },
                    ...
                ]
            }
        }
        ```
    -   Invalid team or duplicate robot in one team
        ```json
        {
            "firstTeam.0": ["The firstTeam.0 field has a duplicate value."],
            "firstTeam.4": ["The firstTeam.4 field has a duplicate value."]
        }
        ```
    -   Duplicate robot in both teams
        ```json
        {
            "message": "Robot exists in both teams!"
        }
        ```

# Containerization

For local development I used [Laravel Valet](https://laravel.com/docs/8.x/valet), if a containerization solution was required i would use [Laradock](https://laradock.io/) for small projects that don't require any advanced configuration. Laradock is a full PHP development environment for Docker.

It supports a variety of common services, all pre-configured to provide a ready PHP development environment. Comes shipped with PHP, NGINX, MySQL, Redis and Composer.

A more custom docker setup can be build in case of limitation with Laradock.

# Hosting

In terms of hosting it depends on what provider but ideally, there needs to be a zero-downtime deployment stack. I would recommend using [Deployer](https://deployer.org/) as it has been tried and tested and provides a super simple setup and process with a minimal learning curve.

# Frontend

For frontend If there is no specific technology, I would recommend using VueJS or React, because of their simplicity and easy integration.

A few pages will need to be built (Login, Register, Robots List, View Individual Robot, Robot Leaderboard, DanceOffs List and the page where robots can battle).

A state management pattern would be used (Vuex or Redux), and I would recommend using a repository pattern also to enforce separation of concerns.

I also recommend using [eslint](https://eslint.org/) and [prettier](https://prettier.io/) to manage code style.

# Testing

For Backend i would use [PhpUnit](https://phpunit.de/) to create tests for unit testing and functional testing.

As for frontend i would recommend using [Jest](https://jestjs.io/).
